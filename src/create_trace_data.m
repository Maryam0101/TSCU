clear all
close all
clc

root='/Users/hkaya/Documents/Ozel/Projeler/diagnus/Screener/dataset/Disease02/1';


wt={...
    'WTD02M0101.scf', 869,... % 869 869
    'WTD02M0102.scf', 874,... % 874 874
    'WTD02M0103.scf', 873,... % 873 873
    'WTD02M0104.scf', 883,... % 883 886
    'WTD02M0105.scf', 762,... % 762 759
    'WTD02M0106.scf', 917,... % 917 920
    'WTD02M0107.scf', 895,...
    'WTD02M0108.scf', 1173,...
    'WTD02M0109.scf', 923,...
    'WTD02M0110.scf', 866,...
    'WTD02M0111.scf', 876,...
    'WTD02M0112.scf', 868,...
    'WTD02M0113.scf', 915,...
    'WTD02M0114.scf', 850,...
    'WTD02M0115.scf', 841,...
    'WTD02M0116.scf', 803,...
    'WTD02M0117.scf', 893,...
    'WTD02M0118.scf', 807,...
    'WTD02M0119.scf', 795,...
    'WTD02M0120.scf', 834,...
    'WTD02M0121.scf', 938,...
    'WTD02M0122.scf', 907};
ht = {...
'HTD02M0101.scf',869,... % 869 869
'HTD02M0102.scf',811,... % 811 811
'HTD02M0103.scf',900,... % 900 900
'HTD02M0104.scf',894,... % 894 897
'HTD02M0105.scf',897,... % 897 894
'HTD02M0106.scf',873,... % 873 876
'HTD02M0107.scf',656,...
'HTD02M0108.scf',813,...
'HTD02M0109.scf',954,...
'HTD02M0110.scf',922,...
'HTD02M0111.scf',875,...
'HTD02M0112.scf',899,...
'HTD02M0113.scf',947,...
'HTD02M0114.scf',949,...
'HTD02M0115.scf',805,...
'HTD02M0116.scf',835,...
'HTD02M0117.scf',756,...
'HTD02M0118.scf',940,...
'HTD02M0119.scf',824,...
'HTD02M0120.scf',932,...
'HTD02M0121.scf',895,...
'HTD02M0122.scf',852};

n = 50;

wtdata = zeros(22,2*n+1);
htdata = zeros(22,2*n+1);
for i=1:22
    [A,C,G,T,P_A,P_C,P_G,P_T,COMMENTS,PEAK_INDEX,BASE] = ...
        scfread(sprintf('%s/WT/%s',root,wt{2*i-1}));
    loc=wt{2*i};
    d = loc-n:loc+n-1;
    subplot(221); plot(A(d)); hold on; title('A'); xlim([1 2*n]);
    subplot(222); plot(C(d)); hold on; title('C'); xlim([1 2*n]);
    subplot(223); plot(G(d)); hold on; title('G'); xlim([1 2*n]);
    subplot(224); plot(T(d)); hold on; title('T'); xlim([1 2*n]);
    wtdata(i,:)=[1 max([A(d) C(d) G(d) T(d)]')];
end

figure
for i=1:22
    [A,C,G,T,P_A,P_C,P_G,P_T,COMMENTS,PEAK_INDEX,BASE] = ...
        scfread(sprintf('%s/HT/%s',root,ht{2*i-1}));
    loc=ht{2*i};
    d = loc-n:loc+n-1;
    subplot(221); plot(A(d)); hold on; title('A'); xlim([1 2*n]);
    subplot(222); plot(C(d)); hold on; title('C'); xlim([1 2*n]);
    subplot(223); plot(G(d)); hold on; title('G'); xlim([1 2*n]);
    subplot(224); plot(T(d)); hold on; title('T'); xlim([1 2*n]);
    htdata(i,:)=[2 max([A(d) C(d) G(d) T(d)]')];

end

%trn = [wtdata(1:3,:);htdata(1:3,:)];
%tst = [wtdata(4:6,:);htdata(4:6,:)];
trn = [wtdata(1:11,:);htdata(1:11,:)];
tst = [wtdata(12:22,:);htdata(12:22,:)];

figure;
subplot(221); plot(trn(trn(:,1)==1,2:end)','k'); title('1 trn');
subplot(222); plot(trn(trn(:,1)==2,2:end)','k'); title('2 trn');
subplot(223); plot(tst(tst(:,1)==1,2:end)','k'); title('1 tst');
subplot(224); plot(tst(tst(:,1)==2,2:end)','k'); title('2 tst');
save('../data/TRACE_TMP_TRAIN','trn','-ascii');
save('../data/TRACE_TMP_TEST','tst','-ascii');
%tscu(trn,tst,'Alignment','None');
%tscu(trn,tst,'Alignment','DTW');
%tscu(trn,tst,'Alignment','CDTW');
%tscu(trn,tst,'Alignment','SAGA','MATLABPool','64procs');
